#!/bin/bash

if [ "$ENABLE_DEBUG" == "true" ]; then
  echo $'\n'JAVA_DEBUG="-Dwas.debug.mode=true -Dcom.ibm.websphere.ras.inject.at.transform=true -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=${WLP_DEBUG_ADDRESS}"$'\n' >> /opt/ibm/wlp/usr/servers/defaultServer/server.env;
fi
if [ "$ENABLE_JOLOKIA" == "false" ]; then  
	#echo "-javaagent:$WORKDIR/jolokia.jar=port=$JOLOKIA_PORT,protocol=https,caCert=/var/run/secrets/kubernetes.io/serviceaccount/ca.crt,clientPrincipal=cn=system:master-proxy,useSslClientAuthentication=true,extraClientCheck=true,host=0.0.0.0,discoveryEnabled=false"$'\n' >> /opt/ibm/wlp/usr/servers/defaultServer/jvm.options;
	#cp $WORKDIR/jolokia.war /config/dropins
	export JOLOKIA_PORT=-1
fi	      
/opt/ibm/wlp/bin/server run defaultServer